[2018-05-08 10:24:29,638] ERROR Closing socket for /172.31.34.212 because of error (kafka.network.Processor)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:197)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:384)
	at kafka.utils.Utils$.read(Utils.scala:375)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Processor.read(SocketServer.scala:347)
	at kafka.network.Processor.run(SocketServer.scala:245)
	at java.lang.Thread.run(Thread.java:748)
[2018-05-08 10:24:29,642] INFO Closing socket connection to /172.31.34.212. (kafka.network.Processor)
[2018-05-08 10:30:09,645] INFO Verifying properties (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,722] INFO Property broker.id is overridden to 0 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,723] INFO Property log.cleaner.enable is overridden to false (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,723] INFO Property log.dirs is overridden to /tmp/kafka-logs-0 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,724] INFO Property log.retention.check.interval.ms is overridden to 60000 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,724] INFO Property log.retention.hours is overridden to 168 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,725] INFO Property log.segment.bytes is overridden to 536870912 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,725] INFO Property num.io.threads is overridden to 8 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,726] INFO Property num.network.threads is overridden to 2 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,726] INFO Property num.partitions is overridden to 2 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,726] INFO Property port is overridden to 9090 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,727] INFO Property socket.receive.buffer.bytes is overridden to 1048576 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,727] INFO Property socket.request.max.bytes is overridden to 104857600 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,727] INFO Property socket.send.buffer.bytes is overridden to 1048576 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,728] INFO Property zookeeper.connect is overridden to 172.31.34.212:2181 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,728] INFO Property zookeeper.connection.timeout.ms is overridden to 1000000 (kafka.utils.VerifiableProperties)
[2018-05-08 10:30:09,758] INFO [Kafka Server 0], starting (kafka.server.KafkaServer)
[2018-05-08 10:30:09,759] INFO [Kafka Server 0], Connecting to zookeeper on 172.31.34.212:2181 (kafka.server.KafkaServer)
[2018-05-08 10:30:10,366] INFO Loading log 'test001-0' (kafka.log.LogManager)
[2018-05-08 10:30:10,403] INFO Recovering unflushed segment 0 in log test001-0. (kafka.log.Log)
[2018-05-08 10:30:10,425] INFO Completed load of log test001-0 with log end offset 3 (kafka.log.Log)
[2018-05-08 10:30:10,450] INFO Starting log cleanup with a period of 60000 ms. (kafka.log.LogManager)
[2018-05-08 10:30:10,460] INFO Starting log flusher with a default period of 9223372036854775807 ms. (kafka.log.LogManager)
[2018-05-08 10:30:10,490] INFO Awaiting socket connections on 0.0.0.0:9090. (kafka.network.Acceptor)
[2018-05-08 10:30:10,492] INFO [Socket Server on Broker 0], Started (kafka.network.SocketServer)
[2018-05-08 10:30:10,684] INFO Will not load MX4J, mx4j-tools.jar is not in the classpath (kafka.utils.Mx4jLoader$)
[2018-05-08 10:30:10,726] INFO 0 successfully elected as leader (kafka.server.ZookeeperLeaderElector)
[2018-05-08 10:30:11,077] INFO Registered broker 0 at path /brokers/ids/0 with address ip-172-31-34-212.us-east-2.compute.internal:9090. (kafka.utils.ZkUtils$)
[2018-05-08 10:30:11,086] INFO New leader is 0 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2018-05-08 10:30:11,105] INFO [Kafka Server 0], started (kafka.server.KafkaServer)
[2018-05-08 10:30:11,506] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions [test001,0] (kafka.server.ReplicaFetcherManager)
[2018-05-08 10:30:11,576] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions [test001,0] (kafka.server.ReplicaFetcherManager)
[2018-05-08 10:30:28,483] ERROR Closing socket for /172.31.34.212 because of error (kafka.network.Processor)
kafka.common.KafkaException: number of topics has value -1 which is not in the range (0,2147483647).
	at kafka.api.ApiUtils$.readIntInRange(ApiUtils.scala:85)
	at kafka.api.TopicMetadataRequest$.readFrom(TopicMetadataRequest.scala:41)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.network.RequestChannel$Request.<init>(RequestChannel.scala:50)
	at kafka.network.Processor.read(SocketServer.scala:353)
	at kafka.network.Processor.run(SocketServer.scala:245)
	at java.lang.Thread.run(Thread.java:748)
[2018-05-08 10:50:40,185] ERROR Closing socket for /172.31.34.212 because of error (kafka.network.Processor)
kafka.common.KafkaException: number of topics has value -1 which is not in the range (0,2147483647).
	at kafka.api.ApiUtils$.readIntInRange(ApiUtils.scala:85)
	at kafka.api.TopicMetadataRequest$.readFrom(TopicMetadataRequest.scala:41)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.network.RequestChannel$Request.<init>(RequestChannel.scala:50)
	at kafka.network.Processor.read(SocketServer.scala:353)
	at kafka.network.Processor.run(SocketServer.scala:245)
	at java.lang.Thread.run(Thread.java:748)
[2018-05-08 10:53:23,446] INFO Verifying properties (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,522] INFO Property broker.id is overridden to 0 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,527] INFO Property log.cleaner.enable is overridden to false (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,527] INFO Property log.dirs is overridden to /tmp/kafka-logs-0 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,527] INFO Property log.retention.check.interval.ms is overridden to 60000 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,527] INFO Property log.retention.hours is overridden to 168 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,528] INFO Property log.segment.bytes is overridden to 536870912 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,528] INFO Property num.io.threads is overridden to 8 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,528] INFO Property num.network.threads is overridden to 2 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,528] INFO Property num.partitions is overridden to 2 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,529] INFO Property port is overridden to 9090 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,529] INFO Property socket.receive.buffer.bytes is overridden to 1048576 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,530] INFO Property socket.request.max.bytes is overridden to 104857600 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,530] INFO Property socket.send.buffer.bytes is overridden to 1048576 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,530] INFO Property zookeeper.connect is overridden to 172.31.34.212:2181 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,531] INFO Property zookeeper.connection.timeout.ms is overridden to 1000000 (kafka.utils.VerifiableProperties)
[2018-05-08 10:53:23,566] INFO [Kafka Server 0], starting (kafka.server.KafkaServer)
[2018-05-08 10:53:23,567] INFO [Kafka Server 0], Connecting to zookeeper on 172.31.34.212:2181 (kafka.server.KafkaServer)
[2018-05-08 10:53:24,157] INFO Loading log 'test001-0' (kafka.log.LogManager)
[2018-05-08 10:53:24,193] INFO Recovering unflushed segment 0 in log test001-0. (kafka.log.Log)
[2018-05-08 10:53:24,215] INFO Completed load of log test001-0 with log end offset 3 (kafka.log.Log)
[2018-05-08 10:53:24,242] INFO Starting log cleanup with a period of 60000 ms. (kafka.log.LogManager)
[2018-05-08 10:53:24,250] INFO Starting log flusher with a default period of 9223372036854775807 ms. (kafka.log.LogManager)
[2018-05-08 10:53:24,280] INFO Awaiting socket connections on 0.0.0.0:9090. (kafka.network.Acceptor)
[2018-05-08 10:53:24,281] INFO [Socket Server on Broker 0], Started (kafka.network.SocketServer)
[2018-05-08 10:53:24,466] INFO Will not load MX4J, mx4j-tools.jar is not in the classpath (kafka.utils.Mx4jLoader$)
[2018-05-08 10:53:24,517] INFO conflict in /controller data: {"version":1,"brokerid":0,"timestamp":"1525776804476"} stored data: {"version":1,"brokerid":0,"timestamp":"1525775410700"} (kafka.utils.ZkUtils$)
[2018-05-08 10:53:24,558] INFO I wrote this conflicted ephemeral node [{"version":1,"brokerid":0,"timestamp":"1525776804476"}] at /controller a while back in a different session, hence I will backoff for this node to be deleted by Zookeeper and retry (kafka.utils.ZkUtils$)
[2018-05-08 10:53:30,564] INFO conflict in /controller data: {"version":1,"brokerid":0,"timestamp":"1525776804476"} stored data: {"version":1,"brokerid":1,"timestamp":"1525776810008"} (kafka.utils.ZkUtils$)
[2018-05-08 10:53:30,605] INFO conflict in /controller data: {"version":1,"brokerid":0,"timestamp":"1525776810603"} stored data: {"version":1,"brokerid":1,"timestamp":"1525776810008"} (kafka.utils.ZkUtils$)
[2018-05-08 10:53:30,648] INFO Registered broker 0 at path /brokers/ids/0 with address ip-172-31-34-212.us-east-2.compute.internal:9090. (kafka.utils.ZkUtils$)
[2018-05-08 10:53:30,683] INFO [Kafka Server 0], started (kafka.server.KafkaServer)
[2018-05-08 10:53:30,749] INFO New leader is 1 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2018-05-08 10:53:31,291] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions [test001,0] (kafka.server.ReplicaFetcherManager)
[2018-05-08 10:53:31,295] INFO Truncating log test001-0 to offset 3. (kafka.log.Log)
[2018-05-08 10:53:31,328] INFO [ReplicaFetcherManager on broker 0] Added fetcher for partitions ArrayBuffer([[test001,0], initOffset 3 to broker id:1,host:ip-172-31-34-212.us-east-2.compute.internal,port:9091] ) (kafka.server.ReplicaFetcherManager)
[2018-05-08 10:53:31,333] INFO [ReplicaFetcherThread-0-1], Starting  (kafka.server.ReplicaFetcherThread)
[2018-05-08 10:53:45,432] ERROR Closing socket for /172.31.34.212 because of error (kafka.network.Processor)
kafka.common.KafkaException: number of topics has value -1 which is not in the range (0,2147483647).
	at kafka.api.ApiUtils$.readIntInRange(ApiUtils.scala:85)
	at kafka.api.TopicMetadataRequest$.readFrom(TopicMetadataRequest.scala:41)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.network.RequestChannel$Request.<init>(RequestChannel.scala:50)
	at kafka.network.Processor.read(SocketServer.scala:353)
	at kafka.network.Processor.run(SocketServer.scala:245)
	at java.lang.Thread.run(Thread.java:748)
[2018-05-08 10:55:06,400] ERROR Closing socket for /172.31.34.212 because of error (kafka.network.Processor)
kafka.common.KafkaException: number of topics has value -1 which is not in the range (0,2147483647).
	at kafka.api.ApiUtils$.readIntInRange(ApiUtils.scala:85)
	at kafka.api.TopicMetadataRequest$.readFrom(TopicMetadataRequest.scala:41)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.network.RequestChannel$Request.<init>(RequestChannel.scala:50)
	at kafka.network.Processor.read(SocketServer.scala:353)
	at kafka.network.Processor.run(SocketServer.scala:245)
	at java.lang.Thread.run(Thread.java:748)
[2018-05-08 10:57:57,571] ERROR Closing socket for /172.31.34.212 because of error (kafka.network.Processor)
kafka.common.KafkaException: number of topics has value -1 which is not in the range (0,2147483647).
	at kafka.api.ApiUtils$.readIntInRange(ApiUtils.scala:85)
	at kafka.api.TopicMetadataRequest$.readFrom(TopicMetadataRequest.scala:41)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.network.RequestChannel$Request.<init>(RequestChannel.scala:50)
	at kafka.network.Processor.read(SocketServer.scala:353)
	at kafka.network.Processor.run(SocketServer.scala:245)
	at java.lang.Thread.run(Thread.java:748)
[2018-05-08 10:59:07,551] ERROR Closing socket for /172.31.34.212 because of error (kafka.network.Processor)
kafka.common.KafkaException: number of topics has value -1 which is not in the range (0,2147483647).
	at kafka.api.ApiUtils$.readIntInRange(ApiUtils.scala:85)
	at kafka.api.TopicMetadataRequest$.readFrom(TopicMetadataRequest.scala:41)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.api.RequestKeys$$anonfun$4.apply(RequestKeys.scala:39)
	at kafka.network.RequestChannel$Request.<init>(RequestChannel.scala:50)
	at kafka.network.Processor.read(SocketServer.scala:353)
	at kafka.network.Processor.run(SocketServer.scala:245)
	at java.lang.Thread.run(Thread.java:748)
